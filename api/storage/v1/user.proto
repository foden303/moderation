syntax = "proto3";

package storage.v1;

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";

option go_package = "storage/api/storage/v1;v1";
option java_multiple_files = true;
option java_package = "dev.kratos.api.storage.v1";
option java_outer_classname = "StorageProtoV1";

// The user service definition.
service User {
  // Create or update a user
  rpc UpsertUser (UpsertUserRequest) returns (UpsertUserResponse) {
    option (google.api.http) = {
      put: "/storage/user/"
    };
  }
  // Get user by ID
  rpc GetUserByID (GetUserByIDRequest) returns (GetUserByIDResponse) {
    option (google.api.http) = {
      get: "/storage/user/{id}"
    };
  }
  // Check if upload is available for the user
  rpc CheckUploadAvailable (CheckUploadAvailableRequest) returns (CheckUploadAvailableResponse) {
    option (google.api.http) = {
      get: "/storage/user/upload/available"
    };
  }
}
// UpsertUserRequest: Request to create or update a user
message UpsertUserRequest {
  // nickname: User's display name
  string nickname = 1;
  // user_identifier: Unique user identifier (e.g., email or username)
  string user_identifier = 2;
}
// UpsertUserResponse: Response after creating or updating a user
message UpsertUserResponse {}

message CheckUploadAvailableRequest {
  // file_size: Size of the file to check upload availability for
  int64 file_size = 1;
}
// CheckUploadAvailableResponse: Response indicating if upload is available
message CheckUploadAvailableResponse {
  // can_upload: True if the user can upload the file, false otherwise
  bool can_upload = 1;
  // available_storage: Amount of storage available for the user
  int64 available_storage = 2;
  // effective_storage_quota: Total storage quota allocated to the user
  int64 effective_storage_quota = 3;
}

// GetUserByIDRequest: Request to retrieve user information by ID
message GetUserByIDRequest {
}

// GetUserByIDResponse: Response containing user information
message GetUserByIDResponse {
  // id: Unique identifier for the user
  string id = 1;
  // category: User category migrate old data cloud storage v1
  string category = 2;
  // nickname: User's display name
  string nickname = 3;
  // effective_storage_quota: Total storage quota allocated to the user
  int64 effective_storage_quota = 4;
  // storage_photos_used: Storage used by photos
  int64 storage_photos_used = 5;
  // storage_video_used: Storage used by videos
  int64 storage_video_used = 6;
  // storage_document_used: Storage used by documents
  int64 storage_document_used = 7;
  // storage_audio_used: Storage used by audio files
  int64 storage_audio_used = 8;
  // storage_compress_used: Storage used by compressed files
  int64 storage_compress_used = 9;
  // storage_other_used: Storage used by other files
  int64 storage_other_used = 10;
  // storage_total_used: Total storage used by the user
  int64 storage_total_used = 11;
  // created_at: Creation timestamp
  google.protobuf.Timestamp created_at = 12;
  // updated_at: Last update timestamp
  google.protobuf.Timestamp updated_at = 13;
}
