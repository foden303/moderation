server:
  http:
    addr: 0.0.0.0:8082
    timeout: 10s
  grpc:
    addr: 0.0.0.0:9000
    timeout: 10s
data:
  database:
    driver: postgres
    source: postgres://postgres:123456@localhost:5432/moderation?sslmode=disable
    pool:
      max_open_conns: 25
      min_idle_conns: 5
      max_conn_lifetime: 60
      max_conn_idle_time: 10
  redis:
    addr: 127.0.0.1:6379
    read_timeout: 0.2s
    write_timeout: 0.2s

moderation:
  # Legacy fields (kept for backward compatibility during migration)
  vllm:
    enabled: true
    base_url: http://localhost:8000
    model: Qwen/Qwen3Guard-Gen-0.6B
    timeout: 30s

  phash:
    enabled: true
    similarity_threshold: 5

  text:
    reject_threshold: 3
    review_threshold: 2

  nsfw:
    enabled: true
    addr: localhost:50051
    timeout: 30s
    threshold: 0.5

  # New consolidated moderator configuration
  moderator:
    image_moderator:
      workers: 4
      nsfw_threshold: 0.7
      violence_threshold: 0.8
      enable_ocr: false
      timeout: 10s
      bloom_bits: 1048576 # 1<<20
      bloom_hash_funcs: 7
      bloom_key: "moderation:image:bloom"
    
    text_moderator:
      bloom_bits: 8388608 # 8*1024*1024
      bloom_hash_funcs: 5
      bloom_key: "moderation:bloom:badwords"
      reject_threshold: 3
      review_threshold: 2
      enable_llm: true
      vllm_base_url: "http://localhost:8000"
      vllm_model: "Qwen/Qwen3Guard-Gen-0.6B"
      vllm_timeout: 30s

    video_moderator:
      frame_sample_rate: 5
      max_frames_to_check: 10
      enable_audio_check: false
      timeout: 60s
