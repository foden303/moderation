server:
  http:
    addr: 0.0.0.0:8082
    timeout: 10s
  grpc:
    addr: 0.0.0.0:9000
    timeout: 10s
data:
  database:
    driver: postgres
    source: postgres://postgres:123456@localhost:5432/moderation?sslmode=disable
    pool:
      max_open_conns: 25
      min_idle_conns: 5
      max_conn_lifetime: 60
      max_conn_idle_time: 10
  redis:
    addr: 127.0.0.1:6379
    read_timeout: 0.2s
    write_timeout: 0.2s

moderation:
  phash:
    enabled: true
    similarity_threshold: 5

  text:
    reject_threshold: 3
    review_threshold: 2

  nsfw_image:
    enabled: true
    addr: localhost:50051
    timeout: 30s
    threshold: 0.5

  nsfw_text:
    enabled: true
    addr: localhost:50052
    timeout: 30s

  # New consolidated moderator configuration
  moderator:
    image_moderator:
      workers: 4
      bloom_bits: 1048576 # 1<<20
      bloom_hash_funcs: 7
      bloom_key: "moderation:bloom:image"
      nsfw_threshold: 0.7
      violence_threshold: 0.8
      enable_ocr: false
      timeout: 10s
    
    text_moderator:
      bloom_bits: 8388608 # 8*1024*1024
      bloom_hash_funcs: 5
      bloom_key: "moderation:bloom:text"
      reject_threshold: 0.85
      review_threshold: 0.5

    video_moderator:
      frame_sample_rate: 5
      max_frames_to_check: 10
      enable_audio_check: false
      timeout: 60s
